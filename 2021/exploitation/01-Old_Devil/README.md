# [01 - Old_Devil](https://deadface.ctfd.io/challenges#Old%20Devil-25)

## description
```
We found this program written by luciafer. She used it to hide a password in the form of a flag. See if you can find the flag in the program.

Download File
SHA1: dbaec5a38890cb8977865f321de4bf0e8ad2604f
Password: d34df4c3
```

### links

  * [demon.zip](demon.zip)

## walkthrough

```
$ file demon
demon: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID[sha1]=93a6f240fff4506d4b5df573bd1df10bc3717bf0, for GNU/Linux 3.2.0, not stripped
```

from ghidra

```c

undefined8 main(void)

{
  int iVar1;
  byte local_58 [21];
  byte local_43 [11];
  undefined local_38;
  char local_37 [15];
  undefined *local_28;
  undefined *local_20;
  int local_14;
  int local_10;
  char local_9;

  local_9 = 'N';
  local_20 = &DAT_00102008;
  local_28 = &DAT_00102015;
  local_10 = 0;
  while (local_10 < 0x12) {
    if ((&DAT_00102015)[local_10] != '\0') {
      local_58[local_10] = (&DAT_00102015)[local_10] ^ 0xd;
    }
    local_10 = local_10 + 1;
  }
  local_58[17] = 0;
  local_14 = 0;
  while (local_14 < 0xb) {
    if ((&DAT_00102008)[local_14] != '\0') {
      local_43[local_14] = (&DAT_00102008)[local_14] ^ 0xd;
    }
    local_14 = local_14 + 1;
  }
  local_38 = 0;
  puts("\nLuciafer v1.0\nSay the demon\'s name to gain access to the secret.");
  printf("Enter the demon\'s name: ");
  gets(local_37);
  iVar1 = strcmp(local_37,(char *)local_43);
  if (iVar1 == 0) {
    puts("\nYou are correct.");
    local_9 = 'Y';
  }
  else {
    puts("\nThat is not the demon\'s name.");
  }
  if (local_9 != 'N') {
    puts((char *)local_58);
  }
  return 0;
}

```

looks like we could use angr here, but the last few lines re: `local_9` look interesting.. what is in `local_58`?

```
 $ python angr-template.py
round[24]
...
round[11]
WARNING | 2021-10-15 15:11:37,982 | angr.simos.simos | stdin is constrained to 11 bytes (has_end=True). If you are only providing the first 11 bytes instead of the entire stdin, please use stdin=SimFileStream(name='stdin', content=your_first_n_bytes, has_end=False).
b'Adrammelech'
$ ./demon

Luciafer v1.0
Say the demon's name to gain access to the secret.
Enter the demon's name: Adrammelech

You are correct.
flag{AdraMMel3ch}

```



## flag
```
```
