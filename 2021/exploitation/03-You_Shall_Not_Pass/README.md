# [03 - You_Shall_Not_Pass](https://deadface.ctfd.io/challenges#You%20Shall%20Not%20Pass-27)

## description
```
DEADFACE has been targeting De Monne employees based on the recent De Monne financial database leak. De Monne has already changed their employees' passwords, but they would like you to try to crack the victim's password to see how secure it is and what they can do to train their employees to use proper cyber security hygiene. Submit the flag as flag{password}.
```

## walkthrough

ok, so a little OSint, and a little john.

```
$ sqlite3 ../../sql/01-Body_Count/foo.db "select passwd from employee_passwd" > allpasswds.hash
```

let's just see if we can catch them all

```
$ john_rockyou --format=md5crypt-opencl allpasswds.hash
Device 2: NVIDIA GeForce RTX 2060
Using default input encoding: UTF-8
Loaded 4822 password hashes with 4822 different salts (md5crypt-opencl, crypt(3) $1$ [MD5 OpenCL])
LWS=64 GWS=245760 (3840 blocks)
Press 'q' or Ctrl-C to abort, almost any other key for status
0g 0:00:00:12 1.46% (ETA: 20:52:07) 0g/s 0p/s 3647Kc/s 3647KC/s Dev#2:70Â°C 123456..dholly
```

and for some reason, get stuck there.. ok, let's be more targeted. the ghosttown [post](https://ghosttown.deadface.io/t/how-do-i-crack-this-nut/71/8) shows Jeremy Welle and Merrilee Lawless answering some questions we could seed john with.

```
$ sqlite3 ../../sql/01-Body_Count/foo.db
SQLite version 3.34.1 2021-01-20 14:10:07
Enter ".help" for usage hints.
sqlite> .schema employee
sqlite> .schema employees
CREATE TABLE `employees` (
  `employee_id` integer NOT NULL PRIMARY KEY AUTOINCREMENT
,  `last_name` tinytext NOT NULL
,  `first_name` tinytext NOT NULL
,  `email` tinytext NOT NULL
,  `street` tinytext NOT NULL
,  `city` tinytext NOT NULL
,  `state` tinytext NOT NULL
,  `country` tinytext NOT NULL
,  `postal` tinytext NOT NULL
,  `gender` tinytext NOT NULL
,  `employee_code` tinytext NOT NULL
);
sqlite> .schema employee_pass
sqlite> .schema employee_passwd
CREATE TABLE `employee_passwd` (
  `employee_pass_id` integer NOT NULL PRIMARY KEY AUTOINCREMENT
,  `employee_id` integer NOT NULL
,  `passwd` tinytext NOT NULL
,  CONSTRAINT `fk_employee_passwd_employee_id` FOREIGN KEY (`employee_id`) REFERENCES `employees` (`employee_id`) ON DELETE CASCADE
);
CREATE INDEX "idx_employee_passwd_fk_employee_passwd_employee_id" ON "employee_passwd" (`employee_id`);
sqlite> select employee_id,last_name,first_name from employees where last_name = 'Welle';
sqlite> select employee_id,last_name,first_name from employees where last_name = 'Lawless';
2545|Lawless|Merrilee
sqlite> select passwd from employee_passwd where employee_id = 2545;
$1$qcRBMlEm$PQKbbpIFCSSMCTVvvsfve0
```

ok, so Merrilee is the target - and instead of 4,822 hashes to crack, just the one.

built [context.txt](context.txt) from her responses to the "random facts" response

```
$ john --wordlist=context.txt -rules:All merrilee.hash
Warning: detected hash type "md5crypt", but the string is also recognized as "md5crypt-long"
Use the "--format=md5crypt-long" option to force loading these as that type instead
Warning: detected hash type "md5crypt", but the string is also recognized as "md5crypt-opencl"
Use the "--format=md5crypt-opencl" option to force loading these as that type instead
Using default input encoding: UTF-8
Loaded 1 password hash (md5crypt, crypt(3) $1$ (and variants) [MD5 256/256 AVX2 8x3])
Will run 16 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
0g 0:00:00:07 5.89% (ETA: 20:51:11) 0g/s 457508p/s 457508c/s 457508C/s S!prinkeles329..F!riends500
0g 0:00:00:13 12.90% (ETA: 20:50:53) 0g/s 506573p/s 506573c/s 506573C/s Goddard st%01..Sprinkeles.54
0g 0:00:00:38 31.22% (ETA: 20:51:14) 0g/s 526022p/s 526022c/s 526022C/s Crochet=8621..Albany=8775
0g 0:00:01:17 56.91% (ETA: 20:51:28) 0g/s 503668p/s 503668c/s 503668C/s \=Goddard st457..\=Sprinkeles610
0g 0:00:01:59 87.38% (ETA: 20:51:29) 0g/s 492565p/s 492565c/s 492565C/s Albany220925..Purple221117
0g 0:00:02:15 DONE (2021-10-15 20:51) 0g/s 488752p/s 488752c/s 488752C/s Spri21kele21..1973
Session completed.

real    2m15.859s
user    34m51.035s
sys     0m5.062s
```

why would they give all this context and then it not work? oh - i had a typo `Sprinkeles` is not `Sprinkles`, so of course
```
 john --wordlist=context.txt -rules:All merrilee.hash
Warning: detected hash type "md5crypt", but the string is also recognized as "md5crypt-long"
Use the "--format=md5crypt-long" option to force loading these as that type instead
Warning: detected hash type "md5crypt", but the string is also recognized as "md5crypt-opencl"
Use the "--format=md5crypt-opencl" option to force loading these as that type instead
Using default input encoding: UTF-8
Loaded 1 password hash (md5crypt, crypt(3) $1$ (and variants) [MD5 256/256 AVX2 8x3])
Will run 16 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
0g 0:00:00:14 14.12% (ETA: 20:53:46) 0g/s 534694p/s 534694c/s 534694C/s Aspen+dz..Purple+jx
0g 0:00:00:28 24.55% (ETA: 20:54:01) 0g/s 539683p/s 539683c/s 539683C/s Sprinkles71264..Goddard St71418
0g 0:00:00:53 41.62% (ETA: 20:54:14) 0g/s 520507p/s 520507c/s 520507C/s 7646Aspen=..7652Purple+
Sprinkles1973!   (?)
1g 0:00:00:54 DONE (2021-10-15 20:53) 0.01834g/s 519692p/s 519692c/s 519692C/s Aspen1960#..Purple1986$
Use the "--show" option to display all of the cracked passwords reliably
Session completed.

real    0m54.777s
user    13m54.528s
sys     0m2.045s

```

## flag
```
flag{Sprinkles1973!}
```
